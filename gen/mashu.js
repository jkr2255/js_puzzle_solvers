!function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){var r=t("./_root").Symbol;e.exports=r},{"./_root":10}],2:[function(t,e,n){function r(t,e,n){return t===t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}e.exports=r},{}],3:[function(t,e,n){function r(t,e,n,r){var a=t.length;for((n=o(n))<0&&(n=-n>a?0:a+n),(r=void 0===r||r>a?a:o(r))<0&&(r+=a),r=n>r?0:i(r);n<r;)t[n++]=e;return t}var o=t("./toInteger"),i=t("./toLength");e.exports=r},{"./toInteger":20,"./toLength":21}],4:[function(t,e,n){function r(t){return null==t?void 0===t?u:s:f&&f in Object(t)?i(t):a(t)}var o=t("./_Symbol"),i=t("./_getRawTag"),a=t("./_objectToString"),s="[object Null]",u="[object Undefined]",f=o?o.toStringTag:void 0;e.exports=r},{"./_Symbol":1,"./_getRawTag":6,"./_objectToString":9}],5:[function(t,e,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,n){function r(t){var e=a.call(t,u),n=t[u];try{t[u]=void 0;var r=!0}catch(t){}var o=s.call(t);return r&&(e?t[u]=n:delete t[u]),o}var o=t("./_Symbol"),i=Object.prototype,a=i.hasOwnProperty,s=i.toString,u=o?o.toStringTag:void 0;e.exports=r},{"./_Symbol":1}],7:[function(t,e,n){function r(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||i.test(t))&&t>-1&&t%1==0&&t<e}var o=9007199254740991,i=/^(?:0|[1-9]\d*)$/;e.exports=r},{}],8:[function(t,e,n){function r(t,e,n){if(!s(n))return!1;var r=typeof e;return!!("number"==r?i(n)&&a(e,n.length):"string"==r&&e in n)&&o(n[e],t)}var o=t("./eq"),i=t("./isArrayLike"),a=t("./_isIndex"),s=t("./isObject");e.exports=r},{"./_isIndex":7,"./eq":11,"./isArrayLike":13,"./isObject":16}],9:[function(t,e,n){function r(t){return o.call(t)}var o=Object.prototype.toString;e.exports=r},{}],10:[function(t,e,n){var r=t("./_freeGlobal"),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},{"./_freeGlobal":5}],11:[function(t,e,n){function r(t,e){return t===e||t!==t&&e!==e}e.exports=r},{}],12:[function(t,e,n){function r(t,e,n,r){var a=null==t?0:t.length;return a?(n&&"number"!=typeof n&&i(t,e,n)&&(n=0,r=a),o(t,e,n,r)):[]}var o=t("./_baseFill"),i=t("./_isIterateeCall");e.exports=r},{"./_baseFill":3,"./_isIterateeCall":8}],13:[function(t,e,n){function r(t){return null!=t&&i(t.length)&&!o(t)}var o=t("./isFunction"),i=t("./isLength");e.exports=r},{"./isFunction":14,"./isLength":15}],14:[function(t,e,n){function r(t){if(!i(t))return!1;var e=o(t);return e==s||e==u||e==a||e==f}var o=t("./_baseGetTag"),i=t("./isObject"),a="[object AsyncFunction]",s="[object Function]",u="[object GeneratorFunction]",f="[object Proxy]";e.exports=r},{"./_baseGetTag":4,"./isObject":16}],15:[function(t,e,n){function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}var o=9007199254740991;e.exports=r},{}],16:[function(t,e,n){function r(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}e.exports=r},{}],17:[function(t,e,n){function r(t){return null!=t&&"object"==typeof t}e.exports=r},{}],18:[function(t,e,n){function r(t){return"symbol"==typeof t||i(t)&&o(t)==a}var o=t("./_baseGetTag"),i=t("./isObjectLike"),a="[object Symbol]";e.exports=r},{"./_baseGetTag":4,"./isObjectLike":17}],19:[function(t,e,n){function r(t){return t?(t=o(t),t===i||t===-i?(t<0?-1:1)*a:t===t?t:0):0===t?t:0}var o=t("./toNumber"),i=1/0,a=1.7976931348623157e308;e.exports=r},{"./toNumber":22}],20:[function(t,e,n){function r(t){var e=o(t),n=e%1;return e===e?n?e-n:e:0}var o=t("./toFinite");e.exports=r},{"./toFinite":19}],21:[function(t,e,n){function r(t){return t?o(i(t),0,a):0}var o=t("./_baseClamp"),i=t("./toInteger"),a=4294967295;e.exports=r},{"./_baseClamp":2,"./toInteger":20}],22:[function(t,e,n){function r(t){if("number"==typeof t)return t;if(i(t))return a;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=f.test(t);return n||c.test(t)?l(t.slice(2),n?2:8):u.test(t)?a:+t}var o=t("./isObject"),i=t("./isSymbol"),a=NaN,s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=r},{"./isObject":16,"./isSymbol":18}],23:[function(t,e,n){"use strict";function r(t,e){var n=[];if((e=+e)<0||e>t.length)return[];if(0==e)return[[]];if(1==e)return t.map(function(t){return[t]});if(e==t.length-1){var i=function(){var e=void 0;for(e=0;e<t.length;++e)n.push(t.filter(function(t,n){return n!==e}));return{v:n}}();if("object"===(void 0===i?"undefined":o(i)))return i.v}var a=[].concat(t);if(e==t.length)return[a];for(;;){if(a.length===e){n.push(a);break}var s=[a.pop()],u=r(a,e-1),f=void 0;for(f=0;f<u.length;++f)n.push(u[f].concat(s))}return n}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=r},{}],24:[function(t,e,n){"use strict";e.exports="function"==typeof Worker&&"function"==typeof Int32Array},{}],25:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){return Math.round(1e6*t)/1e6}var i;i=performance&&performance.now?function(){return performance.now()}:Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},e.exports=function(){function t(e){r(this,t),this.output=e}return t.prototype.start=function(){this.start_time=this.lap_time=i()},t.prototype.lap=function(t){var e=i();this.output(t+": "+o(e-this.lap_time)+" ms"),this.lap_time=e},t.prototype.finish=function(t){t&&this.lap(t),this.output("合計時間: "+o(this.lap_time-this.start_time)+" ms")},t}()},{}],26:[function(t,e,n){(function(t){var n;n="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,e.exports=function(){function t(t){this.$field=n(t),this.values=[],this.$field.on("click.field","td",function(t){return function(e){var r,o,i,a,s;e.preventDefault(),t.changeDisabled||n.isFunction(t.changeFunc)&&(a=(o=e.target.dataset.pos.split("_"))[0],s=o[1],i=t.getValue(a,s),!1!==(r=t.changeFunc(i,!0,a,s))&&t.setValue(a,s,r))}}(this)),this.$field.on("contextmenu.field","td",function(t){return function(e){var r,o,i,a,s;e.preventDefault(),t.changeDisabled||n.isFunction(t.changeFunc)&&(a=(o=e.target.dataset.pos.split("_"))[0],s=o[1],i=t.getValue(a,s),!1!==(r=t.changeFunc(i,!1,a,s))&&t.setValue(a,s,r))}}(this))}return t.prototype.width=0,t.prototype.height=0,t.prototype.changeFunc=null,t.prototype.changeDisabled=!1,t.prototype.setSize=function(t,e){var r,o,i,a,s,u,f;for(this.width=t,this.height=e,this.values=[],this.$field.empty(),f=o=0,a=e;0<=a?o<a:o>a;f=0<=a?++o:--o)for(r=n("<tr />"),this.$field.append(r),this.values.push([]),u=i=0,s=t;0<=s?i<s:i>s;u=0<=s?++i:--i)n("<td />").attr("data-pos",u+"_"+f).appendTo(r),this.values[f].push("");return this},t.prototype.setValue=function(t,e,n){return this.$field.find("td[data-pos='"+t+"_"+e+"']").text(n),this.values[e][t]=n,this},t.prototype.getValue=function(t,e){return this.values[e][t]},t.prototype.eachCell=function(t){var e,n,r,o,i,a;for(a=e=0,r=this.height;0<=r?e<r:e>r;a=0<=r?++e:--e)for(i=n=0,o=this.width;0<=o?n<o:n>o;i=0<=o?++n:--n)if(!1===t(this.values[a][i],i,a))return!1;return!0},t}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){var e=[],n=void 0===t?"undefined":i(t);if("string"===n)e=t.split(" ");else if("number"===n)e=[t];else{if("[object Array]"!==a.call(t))throw new TypeError;e=t.slice()}for(var r=0;r<e.length;++r){var o=+e[r];if(e[r]=o,(0|o)!==o)throw new RangeError("Only integers are accepted for constraints.")}e.sort(function(t,e){return 0===t&&0===e?0:0===t?1:0===e?-1:Math.abs(t)-Math.abs(e)});for(var s=0,u=0;u<e.length;++u)if(s<Math.abs(e[u])&&(s=Math.abs(e[u])),u<e.length-1&&0!==e[u]&&e[u]+e[u+1]===0)return{text:"",maxVar:0};for(;0===e[e.length-1];)e.pop();return e.push(0),{text:e.join(" "),maxVar:s}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.prototype.toString,s=function(){function t(){r(this,t),this.clear()}return t.prototype.clear=function(){this.textConstraints=[],this.maxVar=0},t.prototype.add=function(t){var e=o(t);return e.maxVar>0&&(this.textConstraints.push(e.text),this.maxVar<e.maxVar&&(this.maxVar=e.maxVar)),this},t.prototype.length=function(){return this.textConstraints.length},t.prototype.merge=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;++r){for(var o=0;o<e[r].textConstraints.length;++o)this.textConstraints.push(e[r].textConstraints[o]);this.maxVar<e[r].maxVar&&(this.maxVar=e[r].maxVar)}return this},t.prototype.toDIMACS=function(){return"p cnf "+this.maxVar+" "+this.textConstraints.length+"\n"+this.textConstraints.join("\n")},t.merge=function(){var e=new t;return e.merge.apply(e,arguments),e},t}();e.exports=s},{}],28:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=t("./sat_constraints"),i=function(){function t(){r(this,t)}return t.prototype.loadWorker=function(){this.worker=new Worker("gen/minisat_worker.js")},t.prototype.setListener=function(t){this.worker||this.loadWorker(),this.listener&&this.worker.removeEventListener("message",this.listener,!0),this.listener=function(e){var n=e.data.result,r=null,o="ERROR";n&&(o=(r=n.split(" ")).shift(),r=r.map(function(t){return+t})),t(o,r,e.data.stdout,e.data.stderr)},this.worker.addEventListener("message",this.listener,!0)},t.prototype.solve=function(t,e){var n=t.toDIMACS();this.setListener(e),this.worker.postMessage(n)},t.prototype.solve_loop=function(t,e){var n=this;this.setListener(function(r,i,a,s){var u=e(t,r,i,a,s);if(!1!==u){if(u instanceof o)return t=u,void n.worker.postMessage(u.toDIMACS());throw new TypeError}}),this.worker.postMessage(t.toDIMACS())},t}();e.exports=i},{"./sat_constraints":27}],29:[function(t,e,n){"use strict";function r(t){return o.push(t),window.postMessage(i,"*"),null}var o=[],i="set_timeout_"+Math.random();window.addEventListener("message",function(t){t.source===window&&t.data===i&&(t.stopPropagation(),o.length>0&&o.shift()())},!0),e.exports=r},{}],30:[function(t,e,n){(function(e){"use strict";var n="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null,r=t("./lib/puzzle_field"),o=t("./lib/environment_check"),i=t("./lib/lap_timer"),a=t("./lib/sat_constraints"),s=t("./lib/sat_solver"),u=t("./lib/set_immediate"),f=t("./lib/combination"),c=t("lodash/fill");n(function(){if(o){var t=new r("#field"),e=new s;e.loadWorker(),n("#make_field_btn").click(function(){var e=parseInt(n("#width").val(),10),r=parseInt(n("#height").val(),10);e>=2&&r>=2?t.setSize(e,r):alert("2×2以上で設定してください。")}),n("#make_field_btn").click(),t.changeFunc=function(t,e){if(e)switch(t){case"○":return"●";case"●":return"";default:return"○"}else switch(t){case"○":return"";case"●":return"○";default:return"●"}};var l=n("#indicator"),p=new i(function(t){return n("<p />").text(t).appendTo(l)});n("#solve_btn").click(function(){function r(t,e,n){var r=+t;if(e=+e,t<0||t>=h||e<0||e>=d)throw new RangeError;if(n){if(e===d-1)throw new RangeError;return d*(h-1)+h*e+r+1}if(t===h-1)throw new RangeError;return(h-1)*e+r+1}function o(t){var e=0,n=0;if((t=+t)<=0)throw new RangeError;return t<=d*(h-1)?(e=(t-1)%(h-1),n=(t-1-e)/(h-1),{x:e,y:n,is_vertical:!1}):(t-=d*(h-1),e=(t-1)%h,n=(t-1-e)/h,{x:e,y:n,is_vertical:!0})}function i(t,e){var n=[];return e>0&&n.push(r(t,e-1,!0)),e<d-1&&n.push(r(t,e,!0)),t>0&&n.push(r(t-1,e,!1)),t<h-1&&n.push(r(t,e,!1)),n}function s(e){u(function(){var n=[],r=void 0,i=void 0,a=void 0,s={3:"│",5:"┌",6:"└",9:"┐",10:"┘",12:"─"};for(a=0;a<d;++a)n.push(c(new Array(h),0));for(r in e){var u=o(r);i=u.x,a=u.y,u.is_vertical?(n[a][i]+=1,n[a+1][i]+=2):(n[a][i]+=4,n[a][i+1]+=8)}t.eachCell(function(e,r,o){"○"!==e&&"●"!==e&&t.setValue(r,o,s[n[o][r]]||"")})})}function l(e,n){var r={},a=[],s=0,u=!1;for(var f in e)r[f]||function(f){for(var c=[],l=o(f),p=l.x,h=l.y,d=l.is_vertical,v=f,y=void 0,b=void 0,g=!1,m=void 0,w=void 0,x=void 0;!r[v];){r[v]=!0,c.push(v),!g&&s<2&&("●"!==(m=t.getValue(p,h))&&"○"!==m||(g=!0,++s));var _=o(v);for(y=_.x,b=_.y,d=_.is_vertical,p!==y||h!==b?(p=y,h=b):d?(p=y,h=b+1):(p=y+1,h=b),w=i(p,h),x=0;x<w.length&&((m=w[x])==v||!e[m]);++x);v=+m}!g||s>=2?(u=!0,n.add(c.map(function(t){return-t}))):a.push(c)}(f);if(s>=2){u=!0;for(var c=0;c<a.length;++c)n.add(a[c].map(function(t){return-t}))}return u}var h=t.width,d=t.height;p.start();var v=new a,y=0;if(t.eachCell(function(t,e,n){var o=0,a=i(e,n);for(f(a,3).forEach(function(t){return void v.add([-t[0],-t[1],-t[2]])}),o=0;o<a.length;++o)v.add(a.map(function(t,e){return e==o?-t:t}));if("●"===t){++y;var s=[],u=[],c=[],l=[];for(n>1&&(s.push(r(e,n-1,!0)),u.push(r(e,n-2,!0))),n<d-2&&(s.push(r(e,n,!0)),u.push(r(e,n+1,!0))),e>1&&(c.push(r(e-1,n,!1)),l.push(r(e-2,n,!1))),e<h-2&&(c.push(r(e,n,!1)),l.push(r(e+1,n,!1))),v.add(s),v.add(c),o=0;o<s.length;++o)v.add([-s[o],u[o]]);for(o=0;o<c.length;++o)v.add([-c[o],l[o]])}else if("○"===t){++y;var p=[],b=[],g=-1,m=-1;for(o=0;o<=3;++o)m=n-2+o,(g=e-2+o)>=0&&g<h-1&&(b[o]=r(g,n,!1)),m>=0&&m<d-1&&(p[o]=r(e,m,!0));var w=p[1]&&p[2],x=b[1]&&b[2];if(!w&&!x)throw alert("角に白丸があって、線を引けません。"),new RangeError;w?x?(v.add([p[1],b[1]]),v.add([-p[1],p[2]]),v.add([-b[1],-p[2]])):(v.add(p[1]),v.add(p[2])):(v.add(b[1]),v.add(b[2])),p[0]&&p[3]&&v.add(p.map(function(t){return-t})),b[0]&&b[3]&&v.add(b.map(function(t){return-t}))}}),p.lap("立式"),0!==y){var b=null;e.solve_loop(v,function(t,e,r){p.lap("ソルバー");var o={},i=0,a="SAT"!==e,u=void 0;if(r)for(u=0;u<r.length;++u)r[u]>0&&(i++,o[r[u]]=!0);s(o);var f=l(o,t);return p.lap("ループチェック"),b?a?(p.finish(),alert("一意解です。"),s(b),!1):f?t:(p.finish(),alert("別解が見つかりました。"),!1):a?(p.finish(),alert("解が見つかりませんでした。"),!1):f?t:n("#bypass_unique").is(":checked")?(p.finish(),!1):(b=o,t.add(Object.keys(o).map(function(t){return-t})),t)}),console.log(v)}else alert("フィールドが空です。終了します。")})}else alert("この環境ではJavaScriptの機能が不足していて、実行できません。")})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/combination":23,"./lib/environment_check":24,"./lib/lap_timer":25,"./lib/puzzle_field":26,"./lib/sat_constraints":27,"./lib/sat_solver":28,"./lib/set_immediate":29,"lodash/fill":12}]},{},[30]);
