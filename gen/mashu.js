!function t(n,e,r){function i(a,s){if(!e[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};n[a][0].call(l.exports,function(t){var e=n[a][1][t];return i(e||t)},l,l.exports,t,n,e,r)}return e[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,n,e){function r(t,n,e,r){var a=t?t.length:0;return a?(e&&"number"!=typeof e&&o(t,n,e)&&(e=0,r=a),i(t,n,e,r)):[]}var i=t("../internal/baseFill"),o=t("../internal/isIterateeCall");n.exports=r},{"../internal/baseFill":2,"../internal/isIterateeCall":7}],2:[function(t,n,e){function r(t,n,e,r){var i=t.length;for((e=null==e?0:+e||0)<0&&(e=-e>i?0:i+e),(r=void 0===r||r>i?i:+r||0)<0&&(r+=i),i=e>r?0:r>>>0,e>>>=0;e<i;)t[e++]=n;return t}n.exports=r},{}],3:[function(t,n,e){function r(t){return function(n){return null==n?void 0:n[t]}}n.exports=r},{}],4:[function(t,n,e){var r=t("./baseProperty")("length");n.exports=r},{"./baseProperty":3}],5:[function(t,n,e){function r(t){return null!=t&&o(i(t))}var i=t("./getLength"),o=t("./isLength");n.exports=r},{"./getLength":4,"./isLength":8}],6:[function(t,n,e){function r(t,n){return t="number"==typeof t||i.test(t)?+t:-1,n=null==n?o:n,t>-1&&t%1==0&&t<n}var i=/^\d+$/,o=9007199254740991;n.exports=r},{}],7:[function(t,n,e){function r(t,n,e){if(!a(e))return!1;var r=typeof n;if("number"==r?i(e)&&o(n,e.length):"string"==r&&n in e){var s=e[n];return t===t?t===s:s!==s}return!1}var i=t("./isArrayLike"),o=t("./isIndex"),a=t("../lang/isObject");n.exports=r},{"../lang/isObject":9,"./isArrayLike":5,"./isIndex":6}],8:[function(t,n,e){function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}var i=9007199254740991;n.exports=r},{}],9:[function(t,n,e){function r(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}n.exports=r},{}],10:[function(t,n,e){"use strict";function r(t,n){var e=[];if((n=+n)<0||n>t.length)return[];if(0==n)return[[]];if(1==n)return t.map(function(t){return[t]});if(n==t.length-1){var o=function(){var n=void 0;for(n=0;n<t.length;++n)e.push(t.filter(function(t,e){return e!==n}));return{v:e}}();if("object"===(void 0===o?"undefined":i(o)))return o.v}var a=[].concat(t);if(n==t.length)return[a];for(;;){if(a.length===n){e.push(a);break}var s=[a.pop()],u=r(a,n-1),f=void 0;for(f=0;f<u.length;++f)e.push(u[f].concat(s))}return e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.exports=r},{}],11:[function(t,n,e){"use strict";n.exports="function"==typeof Worker&&"function"==typeof Int32Array},{}],12:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){return Math.round(1e6*t)/1e6}var o;o=performance&&performance.now?function(){return performance.now()}:Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},n.exports=function(){function t(n){r(this,t),this.output=n}return t.prototype.start=function(){this.start_time=this.lap_time=o()},t.prototype.lap=function(t){var n=o();this.output(t+": "+i(n-this.lap_time)+" ms"),this.lap_time=n},t.prototype.finish=function(t){t&&this.lap(t),this.output("合計時間: "+i(this.lap_time-this.start_time)+" ms")},t}()},{}],13:[function(t,n,e){(function(t){var e;e="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,n.exports=function(){function t(t){this.$field=e(t),this.values=[],this.$field.on("click.field","td",function(t){return function(n){var r,i,o,a,s;n.preventDefault(),t.changeDisabled||e.isFunction(t.changeFunc)&&(a=(i=n.target.dataset.pos.split("_"))[0],s=i[1],o=t.getValue(a,s),!1!==(r=t.changeFunc(o,!0,a,s))&&t.setValue(a,s,r))}}(this)),this.$field.on("contextmenu.field","td",function(t){return function(n){var r,i,o,a,s;n.preventDefault(),t.changeDisabled||e.isFunction(t.changeFunc)&&(a=(i=n.target.dataset.pos.split("_"))[0],s=i[1],o=t.getValue(a,s),!1!==(r=t.changeFunc(o,!1,a,s))&&t.setValue(a,s,r))}}(this))}return t.prototype.width=0,t.prototype.height=0,t.prototype.changeFunc=null,t.prototype.changeDisabled=!1,t.prototype.setSize=function(t,n){var r,i,o,a,s,u,f;for(this.width=t,this.height=n,this.values=[],this.$field.empty(),f=i=0,a=n;0<=a?i<a:i>a;f=0<=a?++i:--i)for(r=e("<tr />"),this.$field.append(r),this.values.push([]),u=o=0,s=t;0<=s?o<s:o>s;u=0<=s?++o:--o)e("<td />").attr("data-pos",u+"_"+f).appendTo(r),this.values[f].push("");return this},t.prototype.setValue=function(t,n,e){return this.$field.find("td[data-pos='"+t+"_"+n+"']").text(e),this.values[n][t]=e,this},t.prototype.getValue=function(t,n){return this.values[n][t]},t.prototype.eachCell=function(t){var n,e,r,i,o,a;for(a=n=0,r=this.height;0<=r?n<r:n>r;a=0<=r?++n:--n)for(o=e=0,i=this.width;0<=i?e<i:e>i;o=0<=i?++e:--e)if(!1===t(this.values[a][o],o,a))return!1;return!0},t}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){var n=[],e=void 0===t?"undefined":o(t);if("string"===e)n=t.split(" ");else if("number"===e)n=[t];else{if("[object Array]"!==a.call(t))throw new TypeError;n=t.slice()}for(var r=0;r<n.length;++r){var i=+n[r];if(n[r]=i,(0|i)!==i)throw new RangeError("Only integers are accepted for constraints.")}n.sort(function(t,n){return 0===t&&0===n?0:0===t?1:0===n?-1:Math.abs(t)-Math.abs(n)});for(var s=0,u=0;u<n.length;++u)if(s<Math.abs(n[u])&&(s=Math.abs(n[u])),u<n.length-1&&0!==n[u]&&n[u]+n[u+1]===0)return{text:"",maxVar:0};for(;0===n[n.length-1];)n.pop();return n.push(0),{text:n.join(" "),maxVar:s}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.prototype.toString,s=function(){function t(){r(this,t),this.clear()}return t.prototype.clear=function(){this.textConstraints=[],this.maxVar=0},t.prototype.add=function(t){var n=i(t);return n.maxVar>0&&(this.textConstraints.push(n.text),this.maxVar<n.maxVar&&(this.maxVar=n.maxVar)),this},t.prototype.length=function(){return this.textConstraints.length},t.prototype.merge=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];for(var r=0;r<n.length;++r){for(var i=0;i<n[r].textConstraints.length;++i)this.textConstraints.push(n[r].textConstraints[i]);this.maxVar<n[r].maxVar&&(this.maxVar=n[r].maxVar)}return this},t.prototype.toDIMACS=function(){return"p cnf "+this.maxVar+" "+this.textConstraints.length+"\n"+this.textConstraints.join("\n")},t.merge=function(){var n=new t;return n.merge.apply(n,arguments),n},t}();n.exports=s},{}],15:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=t("./sat_constraints"),o=function(){function t(){r(this,t)}return t.prototype.loadWorker=function(){this.worker=new Worker("gen/minisat_worker.js")},t.prototype.setListener=function(t){this.worker||this.loadWorker(),this.listener&&this.worker.removeEventListener("message",this.listener,!0),this.listener=function(n){var e=n.data.result,r=null,i="ERROR";e&&(i=(r=e.split(" ")).shift(),r=r.map(function(t){return+t})),t(i,r,n.data.stdout,n.data.stderr)},this.worker.addEventListener("message",this.listener,!0)},t.prototype.solve=function(t,n){var e=t.toDIMACS();this.setListener(n),this.worker.postMessage(e)},t.prototype.solve_loop=function(t,n){var e=this;this.setListener(function(r,o,a,s){var u=n(t,r,o,a,s);if(!1!==u){if(u instanceof i)return t=u,void e.worker.postMessage(u.toDIMACS());throw new TypeError}}),this.worker.postMessage(t.toDIMACS())},t}();n.exports=o},{"./sat_constraints":14}],16:[function(t,n,e){"use strict";function r(t){return i.push(t),window.postMessage(o,"*"),null}var i=[],o="set_timeout_"+Math.random();window.addEventListener("message",function(t){t.source===window&&t.data===o&&(t.stopPropagation(),i.length>0&&i.shift()())},!0),n.exports=r},{}],17:[function(t,n,e){(function(n){"use strict";var e="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null,r=t("./lib/puzzle_field"),i=t("./lib/environment_check"),o=t("./lib/lap_timer"),a=t("./lib/sat_constraints"),s=t("./lib/sat_solver"),u=t("./lib/set_immediate"),f=t("./lib/combination"),l=t("lodash/array/fill");e(function(){if(i){var t=new r("#field"),n=new s;n.loadWorker(),e("#make_field_btn").click(function(){var n=parseInt(e("#width").val(),10),r=parseInt(e("#height").val(),10);n>=2&&r>=2?t.setSize(n,r):alert("2×2以上で設定してください。")}),e("#make_field_btn").click(),t.changeFunc=function(t,n){if(n)switch(t){case"○":return"●";case"●":return"";default:return"○"}else switch(t){case"○":return"";case"●":return"○";default:return"●"}};var c=e("#indicator"),p=new o(function(t){return e("<p />").text(t).appendTo(c)});e("#solve_btn").click(function(){function r(t,n,e){var r=+t;if(n=+n,t<0||t>=h||n<0||n>=d)throw new RangeError;if(e){if(n===d-1)throw new RangeError;return d*(h-1)+h*n+r+1}if(t===h-1)throw new RangeError;return(h-1)*n+r+1}function i(t){var n=0,e=0;if((t=+t)<=0)throw new RangeError;return t<=d*(h-1)?(n=(t-1)%(h-1),e=(t-1-n)/(h-1),{x:n,y:e,is_vertical:!1}):(t-=d*(h-1),n=(t-1)%h,e=(t-1-n)/h,{x:n,y:e,is_vertical:!0})}function o(t,n){var e=[];return n>0&&e.push(r(t,n-1,!0)),n<d-1&&e.push(r(t,n,!0)),t>0&&e.push(r(t-1,n,!1)),t<h-1&&e.push(r(t,n,!1)),e}function s(n){u(function(){var e=[],r=void 0,o=void 0,a=void 0,s={3:"│",5:"┌",6:"└",9:"┐",10:"┘",12:"─"};for(a=0;a<d;++a)e.push(l(new Array(h),0));for(r in n){var u=i(r);o=u.x,a=u.y,u.is_vertical?(e[a][o]+=1,e[a+1][o]+=2):(e[a][o]+=4,e[a][o+1]+=8)}t.eachCell(function(n,r,i){"○"!==n&&"●"!==n&&t.setValue(r,i,s[e[i][r]]||"")})})}function c(n,e){var r={},a=[],s=0,u=!1;for(var f in n)r[f]||function(f){for(var l=[],c=i(f),p=c.x,h=c.y,d=c.is_vertical,v=f,y=void 0,g=void 0,m=!1,w=void 0,b=void 0,x=void 0;!r[v];){r[v]=!0,l.push(v),!m&&s<2&&("●"!==(w=t.getValue(p,h))&&"○"!==w||(m=!0,++s));var _=i(v);for(y=_.x,g=_.y,d=_.is_vertical,p!==y||h!==g?(p=y,h=g):d?(p=y,h=g+1):(p=y+1,h=g),b=o(p,h),x=0;x<b.length&&((w=b[x])==v||!n[w]);++x);v=+w}!m||s>=2?(u=!0,e.add(l.map(function(t){return-t}))):a.push(l)}(f);if(s>=2){u=!0;for(var l=0;l<a.length;++l)e.add(a[l].map(function(t){return-t}))}return u}var h=t.width,d=t.height;p.start();var v=new a,y=0;if(t.eachCell(function(t,n,e){var i=0,a=o(n,e);for(f(a,3).forEach(function(t){return void v.add([-t[0],-t[1],-t[2]])}),i=0;i<a.length;++i)v.add(a.map(function(t,n){return n==i?-t:t}));if("●"===t){++y;var s=[],u=[],l=[],c=[];for(e>1&&(s.push(r(n,e-1,!0)),u.push(r(n,e-2,!0))),e<d-2&&(s.push(r(n,e,!0)),u.push(r(n,e+1,!0))),n>1&&(l.push(r(n-1,e,!1)),c.push(r(n-2,e,!1))),n<h-2&&(l.push(r(n,e,!1)),c.push(r(n+1,e,!1))),v.add(s),v.add(l),i=0;i<s.length;++i)v.add([-s[i],u[i]]);for(i=0;i<l.length;++i)v.add([-l[i],c[i]])}else if("○"===t){++y;var p=[],g=[],m=-1,w=-1;for(i=0;i<=3;++i)w=e-2+i,(m=n-2+i)>=0&&m<h-1&&(g[i]=r(m,e,!1)),w>=0&&w<d-1&&(p[i]=r(n,w,!0));var b=p[1]&&p[2],x=g[1]&&g[2];if(!b&&!x)throw alert("角に白丸があって、線を引けません。"),new RangeError;b?x?(v.add([p[1],g[1]]),v.add([-p[1],p[2]]),v.add([-g[1],-p[2]])):(v.add(p[1]),v.add(p[2])):(v.add(g[1]),v.add(g[2])),p[0]&&p[3]&&v.add(p.map(function(t){return-t})),g[0]&&g[3]&&v.add(g.map(function(t){return-t}))}}),p.lap("立式"),0!==y){var g=null;n.solve_loop(v,function(t,n,r){p.lap("ソルバー");var i={},o=0,a="SAT"!==n,u=void 0;if(r)for(u=0;u<r.length;++u)r[u]>0&&(o++,i[r[u]]=!0);s(i);var f=c(i,t);return p.lap("ループチェック"),g?a?(p.finish(),alert("一意解です。"),s(g),!1):f?t:(p.finish(),alert("別解が見つかりました。"),!1):a?(p.finish(),alert("解が見つかりませんでした。"),!1):f?t:e("#bypass_unique").is(":checked")?(p.finish(),!1):(g=i,t.add(Object.keys(i).map(function(t){return-t})),t)}),console.log(v)}else alert("フィールドが空です。終了します。")})}else alert("この環境ではJavaScriptの機能が不足していて、実行できません。")})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/combination":10,"./lib/environment_check":11,"./lib/lap_timer":12,"./lib/puzzle_field":13,"./lib/sat_constraints":14,"./lib/sat_solver":15,"./lib/set_immediate":16,"lodash/array/fill":1}]},{},[17]);
