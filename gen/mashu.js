!function t(n,e,r){function o(a,s){if(!e[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=e[a]={exports:{}};n[a][0].call(c.exports,function(t){var e=n[a][1][t];return o(e||t)},c,c.exports,t,n,e,r)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,n,e){var r=t("./_root").Symbol;n.exports=r},{"./_root":10}],2:[function(t,n,e){n.exports=function(t,n,e){return t===t&&(void 0!==e&&(t=t<=e?t:e),void 0!==n&&(t=t>=n?t:n)),t}},{}],3:[function(t,n,e){var r=t("./toInteger"),o=t("./toLength");n.exports=function(t,n,e,i){var a=t.length;for((e=r(e))<0&&(e=-e>a?0:a+e),(i=void 0===i||i>a?a:r(i))<0&&(i+=a),i=e>i?0:o(i);e<i;)t[e++]=n;return t}},{"./toInteger":20,"./toLength":21}],4:[function(t,n,e){var r=t("./_Symbol"),o=t("./_getRawTag"),i=t("./_objectToString"),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;n.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?o(t):i(t)}},{"./_Symbol":1,"./_getRawTag":6,"./_objectToString":9}],5:[function(t,n,e){(function(t){var e="object"==typeof t&&t&&t.Object===Object&&t;n.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,n,e){var r=t("./_Symbol"),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;n.exports=function(t){var n=i.call(t,s),e=t[s];try{t[s]=void 0;var r=!0}catch(t){}var o=a.call(t);return r&&(n?t[s]=e:delete t[s]),o}},{"./_Symbol":1}],7:[function(t,n,e){var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;n.exports=function(t,n){return!!(n=null==n?r:n)&&("number"==typeof t||o.test(t))&&t>-1&&t%1==0&&t<n}},{}],8:[function(t,n,e){var r=t("./eq"),o=t("./isArrayLike"),i=t("./_isIndex"),a=t("./isObject");n.exports=function(t,n,e){if(!a(e))return!1;var s=typeof n;return!!("number"==s?o(e)&&i(n,e.length):"string"==s&&n in e)&&r(e[n],t)}},{"./_isIndex":7,"./eq":11,"./isArrayLike":13,"./isObject":16}],9:[function(t,n,e){var r=Object.prototype.toString;n.exports=function(t){return r.call(t)}},{}],10:[function(t,n,e){var r=t("./_freeGlobal"),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();n.exports=i},{"./_freeGlobal":5}],11:[function(t,n,e){n.exports=function(t,n){return t===n||t!==t&&n!==n}},{}],12:[function(t,n,e){var r=t("./_baseFill"),o=t("./_isIterateeCall");n.exports=function(t,n,e,i){var a=null==t?0:t.length;return a?(e&&"number"!=typeof e&&o(t,n,e)&&(e=0,i=a),r(t,n,e,i)):[]}},{"./_baseFill":3,"./_isIterateeCall":8}],13:[function(t,n,e){var r=t("./isFunction"),o=t("./isLength");n.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},{"./isFunction":14,"./isLength":15}],14:[function(t,n,e){var r=t("./_baseGetTag"),o=t("./isObject"),i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";n.exports=function(t){if(!o(t))return!1;var n=r(t);return n==a||n==s||n==i||n==u}},{"./_baseGetTag":4,"./isObject":16}],15:[function(t,n,e){var r=9007199254740991;n.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},{}],16:[function(t,n,e){n.exports=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}},{}],17:[function(t,n,e){n.exports=function(t){return null!=t&&"object"==typeof t}},{}],18:[function(t,n,e){var r=t("./_baseGetTag"),o=t("./isObjectLike"),i="[object Symbol]";n.exports=function(t){return"symbol"==typeof t||o(t)&&r(t)==i}},{"./_baseGetTag":4,"./isObjectLike":17}],19:[function(t,n,e){var r=t("./toNumber"),o=1/0,i=1.7976931348623157e308;n.exports=function(t){return t?(t=r(t))===o||t===-o?(t<0?-1:1)*i:t===t?t:0:0===t?t:0}},{"./toNumber":22}],20:[function(t,n,e){var r=t("./toFinite");n.exports=function(t){var n=r(t),e=n%1;return n===n?e?n-e:n:0}},{"./toFinite":19}],21:[function(t,n,e){var r=t("./_baseClamp"),o=t("./toInteger"),i=4294967295;n.exports=function(t){return t?r(o(t),0,i):0}},{"./_baseClamp":2,"./toInteger":20}],22:[function(t,n,e){var r=t("./isObject"),o=t("./isSymbol"),i=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,c=parseInt;n.exports=function(t){if("number"==typeof t)return t;if(o(t))return i;if(r(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=r(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var e=u.test(t);return e||f.test(t)?c(t.slice(2),e?2:8):s.test(t)?i:+t}},{"./isObject":16,"./isSymbol":18}],23:[function(t,n,e){"use strict";function r(t,n){var e=[];if((n=+n)<0||n>t.length)return[];if(0==n)return[[]];if(1==n)return t.map(function(t){return[t]});if(n==t.length-1){var i=function(){var n=void 0;for(n=0;n<t.length;++n)e.push(t.filter(function(t,e){return e!==n}));return{v:e}}();if("object"===(void 0===i?"undefined":o(i)))return i.v}var a=[].concat(t);if(n==t.length)return[a];for(;;){if(a.length===n){e.push(a);break}var s=[a.pop()],u=r(a,n-1),f=void 0;for(f=0;f<u.length;++f)e.push(u[f].concat(s))}return e}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.exports=r},{}],24:[function(t,n,e){"use strict";n.exports="function"==typeof Worker&&"function"==typeof Int32Array},{}],25:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t){return Math.round(1e6*t)/1e6}var i;i=performance&&performance.now?function(){return performance.now()}:Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},n.exports=function(){function t(n){r(this,t),this.output=n}return t.prototype.start=function(){this.start_time=this.lap_time=i()},t.prototype.lap=function(t){var n=i();this.output(t+": "+o(n-this.lap_time)+" ms"),this.lap_time=n},t.prototype.finish=function(t){t&&this.lap(t),this.output("合計時間: "+o(this.lap_time-this.start_time)+" ms")},t}()},{}],26:[function(t,n,e){(function(t){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var r="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null;n.exports=function(){function t(n){var o=this;e(this,t),this.width=this.height=0,this.$field=r(n),this.values=[],this.$field.on("click.field","td",function(t){if(t.preventDefault(),!o.changeDisabled&&r.isFunction(o.changeFunc)){var n=t.target.dataset.pos.split("_"),e=n[0],i=n[1],a=o.getValue(e,i),s=o.changeFunc(a,!0,e,i);!1!==s&&o.setValue(e,i,s)}}),this.$field.on("contextmenu.field","td",function(t){if(t.preventDefault(),!o.changeDisabled&&r.isFunction(o.changeFunc)){var n=t.target.dataset.pos.split("_"),e=n[0],i=n[1],a=o.getValue(e,i),s=o.changeFunc(a,!1,e,i);!1!==s&&o.setValue(e,i,s)}})}return t.prototype.setSize=function(t,n){this.width=t,this.height=n,this.values=[],this.$field.empty();for(var e=0;e<n;++e){var o=r("<tr />");this.$field.append(o),this.values.push([]);for(var i=0;i<t;++i)r("<td />").attr("data-pos",i+"_"+e).appendTo(o),this.values[e].push("")}return this},t.prototype.setValue=function(t,n,e){return this.$field.find("td[data-pos='"+t+"_"+n+"']").text(e),this.values[n][t]=e,this},t.prototype.getValue=function(t,n){return this.values[n][t]},t.prototype.eachCell=function(t){for(var n=0;n<this.height;++n)for(var e=0;e<this.width;++e)if(!1===t(this.values[n][e],e,n))return!1;return!0},t}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t){var n=[],e=void 0===t?"undefined":i(t);if("string"===e)n=t.split(" ");else if("number"===e)n=[t];else{if("[object Array]"!==a.call(t))throw new TypeError;n=t.slice()}for(var r=0;r<n.length;++r){var o=+n[r];if(n[r]=o,(0|o)!==o)throw new RangeError("Only integers are accepted for constraints.")}n.sort(function(t,n){return 0===t&&0===n?0:0===t?1:0===n?-1:Math.abs(t)-Math.abs(n)});for(var s=0,u=0;u<n.length;++u)if(s<Math.abs(n[u])&&(s=Math.abs(n[u])),u<n.length-1&&0!==n[u]&&n[u]+n[u+1]===0)return{text:"",maxVar:0};for(;0===n[n.length-1];)n.pop();return n.push(0),{text:n.join(" "),maxVar:s}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.prototype.toString,s=function(){function t(){r(this,t),this.clear()}return t.prototype.clear=function(){this.textConstraints=[],this.maxVar=0},t.prototype.add=function(t){var n=o(t);return n.maxVar>0&&(this.textConstraints.push(n.text),this.maxVar<n.maxVar&&(this.maxVar=n.maxVar)),this},t.prototype.length=function(){return this.textConstraints.length},t.prototype.merge=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];for(var r=0;r<n.length;++r){for(var o=0;o<n[r].textConstraints.length;++o)this.textConstraints.push(n[r].textConstraints[o]);this.maxVar<n[r].maxVar&&(this.maxVar=n[r].maxVar)}return this},t.prototype.toDIMACS=function(){return"p cnf "+this.maxVar+" "+this.textConstraints.length+"\n"+this.textConstraints.join("\n")},t.merge=function(){var n=new t;return n.merge.apply(n,arguments),n},t}();n.exports=s},{}],28:[function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=t("./sat_constraints"),i=function(){function t(){r(this,t)}return t.prototype.loadWorker=function(){this.worker=new Worker("gen/minisat_worker.js")},t.prototype.setListener=function(t){this.worker||this.loadWorker(),this.listener&&this.worker.removeEventListener("message",this.listener,!0),this.listener=function(n){var e=n.data.result,r=null,o="ERROR";e&&(o=(r=e.split(" ")).shift(),r=r.map(function(t){return+t})),t(o,r,n.data.stdout,n.data.stderr)},this.worker.addEventListener("message",this.listener,!0)},t.prototype.solve=function(t,n){var e=t.toDIMACS();this.setListener(n),this.worker.postMessage(e)},t.prototype.solve_loop=function(t,n){var e=this;this.setListener(function(r,i,a,s){var u=n(t,r,i,a,s);if(!1!==u){if(u instanceof o)return t=u,void e.worker.postMessage(u.toDIMACS());throw new TypeError}}),this.worker.postMessage(t.toDIMACS())},t}();n.exports=i},{"./sat_constraints":27}],29:[function(t,n,e){"use strict";var r=[],o="set_timeout_"+Math.random();window.addEventListener("message",function(t){t.source===window&&t.data===o&&(t.stopPropagation(),r.length>0&&r.shift()())},!0),n.exports=function(t){return r.push(t),window.postMessage(o,"*"),null}},{}],30:[function(t,n,e){(function(n){"use strict";var e="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null,r=t("./lib/puzzle_field"),o=t("./lib/environment_check"),i=t("./lib/lap_timer"),a=t("./lib/sat_constraints"),s=t("./lib/sat_solver"),u=t("./lib/set_immediate"),f=t("./lib/combination"),c=t("lodash/fill");e(function(){if(o){var t=new r("#field"),n=new s;n.loadWorker(),e("#make_field_btn").click(function(){var n=parseInt(e("#width").val(),10),r=parseInt(e("#height").val(),10);n>=2&&r>=2?t.setSize(n,r):alert("2×2以上で設定してください。")}),e("#make_field_btn").click(),t.changeFunc=function(t,n){if(n)switch(t){case"○":return"●";case"●":return"";default:return"○"}else switch(t){case"○":return"";case"●":return"○";default:return"●"}};var l=e("#indicator"),p=new i(function(t){return e("<p />").text(t).appendTo(l)});e("#solve_btn").click(function(){function r(t,n,e){var r=+t;if(n=+n,t<0||t>=h||n<0||n>=d)throw new RangeError;if(e){if(n===d-1)throw new RangeError;return d*(h-1)+h*n+r+1}if(t===h-1)throw new RangeError;return(h-1)*n+r+1}function o(t){var n=0,e=0;if((t=+t)<=0)throw new RangeError;return t<=d*(h-1)?(n=(t-1)%(h-1),e=(t-1-n)/(h-1),{x:n,y:e,is_vertical:!1}):(t-=d*(h-1),n=(t-1)%h,e=(t-1-n)/h,{x:n,y:e,is_vertical:!0})}function i(t,n){var e=[];return n>0&&e.push(r(t,n-1,!0)),n<d-1&&e.push(r(t,n,!0)),t>0&&e.push(r(t-1,n,!1)),t<h-1&&e.push(r(t,n,!1)),e}function s(n){u(function(){var e=[],r=void 0,i=void 0,a=void 0,s={3:"│",5:"┌",6:"└",9:"┐",10:"┘",12:"─"};for(a=0;a<d;++a)e.push(c(new Array(h),0));for(r in n){var u=o(r);i=u.x,a=u.y,u.is_vertical?(e[a][i]+=1,e[a+1][i]+=2):(e[a][i]+=4,e[a][i+1]+=8)}t.eachCell(function(n,r,o){"○"!==n&&"●"!==n&&t.setValue(r,o,s[e[o][r]]||"")})})}function l(n,e){var r={},a=[],s=0,u=!1;for(var f in n)r[f]||function(f){for(var c=[],l=o(f),p=l.x,h=l.y,d=l.is_vertical,v=f,y=void 0,b=void 0,g=!1,m=void 0,w=void 0,x=void 0;!r[v];){r[v]=!0,c.push(v),!g&&s<2&&("●"!==(m=t.getValue(p,h))&&"○"!==m||(g=!0,++s));var _=o(v);for(y=_.x,b=_.y,d=_.is_vertical,p!==y||h!==b?(p=y,h=b):d?(p=y,h=b+1):(p=y+1,h=b),w=i(p,h),x=0;x<w.length&&((m=w[x])==v||!n[m]);++x);v=+m}!g||s>=2?(u=!0,e.add(c.map(function(t){return-t}))):a.push(c)}(f);if(s>=2){u=!0;for(var c=0;c<a.length;++c)e.add(a[c].map(function(t){return-t}))}return u}var h=t.width,d=t.height;p.start();var v=new a,y=0;if(t.eachCell(function(t,n,e){var o=0,a=i(n,e);for(f(a,3).forEach(function(t){return void v.add([-t[0],-t[1],-t[2]])}),o=0;o<a.length;++o)v.add(a.map(function(t,n){return n==o?-t:t}));if("●"===t){++y;var s=[],u=[],c=[],l=[];for(e>1&&(s.push(r(n,e-1,!0)),u.push(r(n,e-2,!0))),e<d-2&&(s.push(r(n,e,!0)),u.push(r(n,e+1,!0))),n>1&&(c.push(r(n-1,e,!1)),l.push(r(n-2,e,!1))),n<h-2&&(c.push(r(n,e,!1)),l.push(r(n+1,e,!1))),v.add(s),v.add(c),o=0;o<s.length;++o)v.add([-s[o],u[o]]);for(o=0;o<c.length;++o)v.add([-c[o],l[o]])}else if("○"===t){++y;var p=[],b=[],g=-1,m=-1;for(o=0;o<=3;++o)m=e-2+o,(g=n-2+o)>=0&&g<h-1&&(b[o]=r(g,e,!1)),m>=0&&m<d-1&&(p[o]=r(n,m,!0));var w=p[1]&&p[2],x=b[1]&&b[2];if(!w&&!x)throw alert("角に白丸があって、線を引けません。"),new RangeError;w?x?(v.add([p[1],b[1]]),v.add([-p[1],p[2]]),v.add([-b[1],-p[2]])):(v.add(p[1]),v.add(p[2])):(v.add(b[1]),v.add(b[2])),p[0]&&p[3]&&v.add(p.map(function(t){return-t})),b[0]&&b[3]&&v.add(b.map(function(t){return-t}))}}),p.lap("立式"),0!==y){var b=null;n.solve_loop(v,function(t,n,r){p.lap("ソルバー");var o={},i="SAT"!==n,a=void 0;if(r)for(a=0;a<r.length;++a)r[a]>0&&(0,o[r[a]]=!0);s(o);var u=l(o,t);return p.lap("ループチェック"),b?i?(p.finish(),alert("一意解です。"),s(b),!1):u?t:(p.finish(),alert("別解が見つかりました。"),!1):i?(p.finish(),alert("解が見つかりませんでした。"),!1):u?t:e("#bypass_unique").is(":checked")?(p.finish(),!1):(b=o,t.add(Object.keys(o).map(function(t){return-t})),t)}),console.log(v)}else alert("フィールドが空です。終了します。")})}else alert("この環境ではJavaScriptの機能が不足していて、実行できません。")})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/combination":23,"./lib/environment_check":24,"./lib/lap_timer":25,"./lib/puzzle_field":26,"./lib/sat_constraints":27,"./lib/sat_solver":28,"./lib/set_immediate":29,"lodash/fill":12}]},{},[30]);
