!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={};n.m=t,n.c=r,n.d=function(t,r,e){n.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=37)}([function(t,n,r){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){var n=[],r=void 0===t?"undefined":o(t);if("string"===r)n=t.split(" ");else if("number"===r)n=[t];else{if("[object Array]"!==a.call(t))throw new TypeError;n=t.slice()}for(var e=0;e<n.length;++e){var i=+n[e];if(n[e]=i,(0|i)!==i)throw new RangeError("Only integers are accepted for constraints.")}n.sort(function(t,n){return 0===t&&0===n?0:0===t?1:0===n?-1:Math.abs(t)-Math.abs(n)});for(var u=0,c=0;c<n.length;++c)if(u<Math.abs(n[c])&&(u=Math.abs(n[c])),c<n.length-1&&0!==n[c]&&n[c]+n[c+1]===0)return{text:"",maxVar:0};for(;0===n[n.length-1];)n.pop();return n.push(0),{text:n.join(" "),maxVar:u}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.prototype.toString,u=function(){function t(){e(this,t),this.clear()}return t.prototype.clear=function(){this.textConstraints=[],this.maxVar=0},t.prototype.add=function(t){var n=i(t);return n.maxVar>0&&(this.textConstraints.push(n.text),this.maxVar<n.maxVar&&(this.maxVar=n.maxVar)),this},t.prototype.length=function(){return this.textConstraints.length},t.prototype.merge=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var e=0;e<n.length;++e){for(var i=0;i<n[e].textConstraints.length;++i)this.textConstraints.push(n[e].textConstraints[i]);this.maxVar<n[e].maxVar&&(this.maxVar=n[e].maxVar)}return this},t.prototype.toDIMACS=function(){return"p cnf "+this.maxVar+" "+this.textConstraints.length+"\n"+this.textConstraints.join("\n")},t.merge=function(){var n=new t;return n.merge.apply(n,arguments),n},t}();t.exports=u},function(t,n){t.exports=riot},function(t,n,r){"use strict";t.exports="function"==typeof Worker&&"function"==typeof Int32Array},function(t,n,r){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){return Math.round(1e6*t)/1e6}var o;o=performance&&performance.now?function(){return performance.now()}:Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},t.exports=function(){function t(n){e(this,t),this.output=n}return t.prototype.start=function(){this.start_time=this.lap_time=o()},t.prototype.lap=function(t){var n=o();this.output(t+": "+i(n-this.lap_time)+" ms"),this.lap_time=n},t.prototype.finish=function(t){t&&this.lap(t),this.output("合計時間: "+i(this.lap_time-this.start_time)+" ms")},t}()},function(t,n,r){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=r(0),o=function(){function t(){e(this,t)}return t.prototype.loadWorker=function(){this.worker=new Worker("gen/minisat_worker.js")},t.prototype.setListener=function(t){this.worker||this.loadWorker(),this.listener&&this.worker.removeEventListener("message",this.listener,!0),this.listener=function(n){var r=n.data.result,e=null,i="ERROR";r&&(e=r.split(" "),i=e.shift(),e=e.map(function(t){return+t})),t(i,e,n.data.stdout,n.data.stderr)},this.worker.addEventListener("message",this.listener,!0)},t.prototype.solve=function(t,n){var r=t.toDIMACS();this.setListener(n),this.worker.postMessage(r)},t.prototype.solve_loop=function(t,n){var r=this;this.setListener(function(e,o,a,u){var c=n(t,e,o,a,u);if(!1!==c){if(c instanceof i)return t=c,void r.worker.postMessage(c.toDIMACS());throw new TypeError}}),this.worker.postMessage(t.toDIMACS())},t}();t.exports=o},function(t,n,r){"use strict";t.exports=function(t,n,r){for(var e=[],i=0;i<n;++i){e.push([]);for(var o=0;o<t;++o)e[i].push(r)}return e}},function(t,n,r){"use strict";function e(t,n){var r=[];if((n=+n)<0||n>t.length)return[];if(0==n)return[[]];if(1==n)return t.map(function(t){return[t]});if(n==t.length-1){var o=function(){var n=void 0;for(n=0;n<t.length;++n)r.push(t.filter(function(t,r){return r!==n}));return{v:r}}();if("object"===(void 0===o?"undefined":i(o)))return o.v}var a=[].concat(t);if(n==t.length)return[a];for(;;){if(a.length===n){r.push(a);break}var u=[a.pop()],c=e(a,n-1),s=void 0;for(s=0;s<c.length;++s)r.push(c[s].concat(u))}return r}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=e},function(t,n,r){"use strict";function e(t){return i.push(t),window.postMessage(o,"*"),null}var i=[],o="set_timeout_"+Math.random();window.addEventListener("message",function(t){t.source===window&&t.data===o&&(t.stopPropagation(),i.length>0&&i.shift()())},!0),t.exports=e},,,,,function(t,n,r){"use strict";t.exports=function(t){return document.addEventListener("DOMContentLoaded",t,!1)}},function(t,n,r){"use strict";r(1).tag2("indicator",'<div class="indicator"> <p each="{mes in messages}">{mes}</p> </div>','indicator .indicator,[data-is="indicator"] .indicator{ height:4.5em; line-height:1.5; overflow-y:auto; border:1px solid #ccc; margin:20px; } indicator .indicator p,[data-is="indicator"] .indicator p{ margin:0 0.5em; }',"",function(t){var n=this,r=n.messages=[];n.log=function(t){r.push(t),n.update()},n.clear=function(){r.length=0,n.update()}})},,,,,,,,,,,,,,,,,,,,,,,,function(t,n,r){"use strict";var e=r(1),i=r(12);r(38),r(13);var o=r(2),a=r(3),u=r(4),c=r(0),s=r(6),l=r(5),f=r(7);i(function(){if(!o)return void alert("この環境ではJavaScriptの機能が不足していて、実行できません。");var t=e.mount("akari-field")[0],n=e.mount("indicator")[0],r=new a(n.log.bind(n)),i=new u;i.loadWorker(),document.getElementById("solve_btn").addEventListener("click",function(){function e(t,n){return t*a+ +n+1}function o(t){!t||t.length<=1||s(t.map(function(t){return-t}),2).forEach(function(t){return h.add(t)})}n.clear(),r.start(),t.creating=!1,t.update();for(var a=t.width,u=t.height,d=l(a,u,null),p=l(a,u,null),h=new c,v=0;v<u;++v){for(var m=null,g=0;g<a;++g)t.data[v][g]>0?(o(m),m=null):(null===m&&(m=[]),m.push(e(v,g)),d[v][g]=m);o(m)}for(var y=0;y<a;++y){for(var w=null,b=0;b<u;++b)t.data[b][y]>0?(o(w),w=null):(null===w&&(w=[]),w.push(e(b,y)),p[b][y]=w);o(w)}for(var x=0;x<u;++x)for(var k=0;k<a;++k){var C=+t.data[x][k];if(C>0){if(h.add(-e(x,k)),6==C)continue;var S=function(t,n){for(var r=[1,0,-1,0],i=[0,1,0,-1],o=[],c=0;c<4;++c){var s=t+r[c],l=n+i[c];0<=s&&s<u&&0<=l&&l<a&&o.push(e(s,l))}return o}(x,k),_=5===C?0:C;if(_>S.length)return void alert("数字がおかしいです。");_>0&&s(S,S.length-_+1).forEach(function(t){return h.add(t)}),_<S.length&&s(S.map(function(t){return-t}),_+1).forEach(function(t){return h.add(t)})}else h.add(d[x][k].concat(p[x][k]).filter(function(t,n,r){return r.indexOf(t)===n}))}r.lap("立式"),i.solve(h,function(n,o,c,s){function l(n){for(var r=0;r<u;++r)for(var i=0;i<a;++i)t.data[r][i]>0||(t.data[r][i]=n[e(r,i)]?-1:0);t.update()}if(r.lap("初回ソルバー"),"SAT"!==n)return void alert("解が見つかりませんでした。");var d={};o.forEach(function(t){return t>0&&(d[t]=!0)}),l(d),r.lap("出力"),h.add(Object.keys(d).map(function(t){return-t})),i.solve(h,function(n,e,o,a){if("SAT"!==n)return r.finish("別解チェック"),void alert("一意解です。");if(document.getElementById("others_reset").checked)return r.finish("別解チェック"),alert("別解があります。"),l({}),void t.update();r.lap("確定マスの抽出");var u=e.filter(function(t){return t>0&&d[t]});h.add(u.map(function(t){return-t})),f(function(){var n={};u.forEach(function(t){return n[t]=!0}),l(n),t.update()}),i.solve_loop(h,function(n,e,i,o,a){return"UNSAT"===e?(r.finish("完了"),alert("別解があります。"),!1):(u=i.filter(function(t){return t>0&&-1!==u.indexOf(t)}),0===u.length?(r.finish("完了"),l({}),t.update(),alert("別解があります。"),!1):(r.lap("確定マスの抽出"),f(function(){var n={};u.forEach(function(t){return n[t]=!0}),l(n),t.update()}),h.add(u.map(function(t){return-t})),h))})})})},!1)})},function(t,n,r){"use strict";r(1).tag2("akari-field",'<div class="control"> <label>幅: <input ref="width" riot-value="{width}" min="2" onchange="{onInputSize}" oninput="{onInputSize}" type="{\'number\'}"></label> × <label>高さ: <input ref="height" riot-value="{height}" min="2" onchange="{onInputSize}" oninput="{onInputSize}" type="{\'number\'}"></label> <input type="button" value="変更 &amp; クリア" onclick="{recreateField}"> </div> <div class="control"> 操作モード： <label><input type="radio" name="creating" value="1" checked="{creating}" onchange="{onCreatingChange}"> 作問</label> <label><input type="radio" name="creating" value="0" checked="{!creating}" onchange="{onCreatingChange}"> 解答</label> </div> <table> <tr each="{row, row_num in data}"> <td each="{item, col_num in row}" class="{num: 0 < item, lit: lit[row_num][col_num]}" data-row="{row_num}" data-col="{col_num}" oncontextmenu="{clearCell}" onclick="{onClickCell}">{disp(item)}</td> </tr> </table>','akari-field div.control,[data-is="akari-field"] div.control{ margin: 5px 0; } akari-field table,[data-is="akari-field"] table{ border-collapse: collapse; border: 2px solid #000; } akari-field td,[data-is="akari-field"] td{ width: 1.5em; height: 1.5em; border: 1px solid #000; vertical-align: middle; text-align: center; } akari-field td.num,[data-is="akari-field"] td.num{ background-color: #000; color: #fff; } akari-field td.lit,[data-is="akari-field"] td.lit{ background-color: #ffc; }',"",function(t){var n=this;n.width=n.height=10,n.creating=!0;var e=r(5);n.recreateField=function(){n.data=e(n.width,n.height,"")},n.recreateField(),n.onInputSize=function(){n.width=n.refs.width.value,n.height=n.refs.height.value},n.onCreatingChange=function(t){n.creating="1"==t.target.value},n.disp=function(t){return""==t?"":5==t?"0":6==t?"":-1==t?"○":t},n.on("update",function(){n.lit=e(n.width,n.height,!1);for(var t=0;t<n.height;++t)for(var r=null,i=!1,o=0;o<n.width;++o){var a=+n.data[t][o];if(a>0)i=!1,r=null;else{if(null===r&&(r=o),-1===a){if(i=!0,null!==r)for(var u=r;u<o;++u)n.lit[t][u]=!0;for(var c=t-1;c>=0&&!(n.data[c][o]>0);--c)n.lit[c][o]=!0;for(var s=t+1;s<n.height&&!(n.data[s][o]>0);++s)n.lit[s][o]=!0}i&&(n.lit[t][o]=!0)}}});var i={6:5,5:1,1:2,2:3,3:4,4:""};n.onClickCell=function(t){var r=t.target.dataset.row,e=t.target.dataset.col,o=n.data[r][e];if(n.creating)return void(n.data[r][e]=o in i?i[o]:6);n.data[r][e]>0||(n.data[r][e]=-1)},n.clearCell=function(t){t.preventDefault();var r=t.target.dataset.row,e=t.target.dataset.col;!n.creating&&n.data[r][e]>0||(n.data[r][e]="")}})}]);