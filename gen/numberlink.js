!function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e){"use strict";function n(t,e){var i=[];if(e=+e,0>e||e>t.length)return[];if(0==e)return[[]];if(1==e)return t.map(function(t){return[t]});if(e==t.length-1){var o=function(){var e=void 0;for(e=0;e<t.length;++e)i.push(t.filter(function(t,n){return n!==e}));return{v:i}}();if("object"===("undefined"==typeof o?"undefined":r(o)))return o.v}var a=[].concat(t);if(e==t.length)return[a];for(;;){if(a.length===e){i.push(a);break}var s=[a.pop()],u=n(a,e-1),f=void 0;for(f=0;f<u.length;++f)i.push(u[f].concat(s))}return i}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=n},{}],2:[function(t,e){"use strict";e.exports="function"==typeof Worker&&"function"==typeof Int32Array},{}],3:[function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return Math.round(1e6*t)/1e6}var i;i=performance&&performance.now?function(){return performance.now()}:Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},e.exports=function(){function t(e){n(this,t),this.output=e}return t.prototype.start=function(){this.start_time=this.lap_time=i()},t.prototype.lap=function(t){var e=i();this.output(t+": "+r(e-this.lap_time)+" ms"),this.lap_time=e},t.prototype.finish=function(t){t&&this.lap(t),this.output("合計時間: "+r(this.lap_time-this.start_time)+" ms")},t}()},{}],4:[function(t,e){(function(t){var n;n="undefined"!=typeof window?window.jQuery:"undefined"!=typeof t?t.jQuery:null,e.exports=function(){function t(t){this.$field=n(t),this.values=[],this.$field.on("click.field","td",function(t){return function(e){var r,i,o,a,s;e.preventDefault(),t.changeDisabled||n.isFunction(t.changeFunc)&&(i=e.target.dataset.pos.split("_"),a=i[0],s=i[1],o=t.getValue(a,s),r=t.changeFunc(o,!0,a,s),r!==!1&&t.setValue(a,s,r))}}(this)),this.$field.on("contextmenu.field","td",function(t){return function(e){var r,i,o,a,s;e.preventDefault(),t.changeDisabled||n.isFunction(t.changeFunc)&&(i=e.target.dataset.pos.split("_"),a=i[0],s=i[1],o=t.getValue(a,s),r=t.changeFunc(o,!1,a,s),r!==!1&&t.setValue(a,s,r))}}(this))}return t.prototype.width=0,t.prototype.height=0,t.prototype.changeFunc=null,t.prototype.changeDisabled=!1,t.prototype.setSize=function(t,e){var r,i,o,a,s,u,f,c;for(this.width=t,this.height=e,this.values=[],this.$field.empty(),c=o=0,s=e;s>=0?s>o:o>s;c=s>=0?++o:--o)for(i=n("<tr />"),this.$field.append(i),this.values.push([]),f=a=0,u=t;u>=0?u>a:a>u;f=u>=0?++a:--a)r=n("<td />"),r.attr("data-pos",f+"_"+c).appendTo(i),this.values[c].push("");return this},t.prototype.setValue=function(t,e,n){return this.$field.find("td[data-pos='"+t+"_"+e+"']").text(n),this.values[e][t]=n,this},t.prototype.getValue=function(t,e){return this.values[e][t]},t.prototype.eachCell=function(t){var e,n,r,i,o,a;for(a=e=0,r=this.height;r>=0?r>e:e>r;a=r>=0?++e:--e)for(o=n=0,i=this.width;i>=0?i>n:n>i;o=i>=0?++n:--n)if(t(this.values[a][o],o,a)===!1)return!1;return!0},t}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){var e=[],n="undefined"==typeof t?"undefined":i(t);if("string"===n)e=t.split(" ");else if("number"===n)e=[t];else{if("[object Array]"!==o.call(t))throw new TypeError;e=t.slice()}for(var r=0;r<e.length;++r){var a=+e[r];if(e[r]=a,(0|a)!==a)throw new RangeError("Only integers are accepted for constraints.")}e.sort(function(t,e){return 0===t&&0===e?0:0===t?1:0===e?-1:Math.abs(t)-Math.abs(e)});for(var s=0,u=0;u<e.length;++u)if(s<Math.abs(e[u])&&(s=Math.abs(e[u])),u<e.length-1&&0!==e[u]&&e[u]+e[u+1]===0)return{text:"",maxVar:0};for(;0===e[e.length-1];)e.pop();return e.push(0),{text:e.join(" "),maxVar:s}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Object.prototype.toString,a=function(){function t(){n(this,t),this.clear()}return t.prototype.clear=function(){this.textConstraints=[],this.maxVar=0},t.prototype.add=function(t){var e=r(t);return e.maxVar>0&&(this.textConstraints.push(e.text),this.maxVar<e.maxVar&&(this.maxVar=e.maxVar)),this},t.prototype.length=function(){return this.textConstraints.length},t.prototype.merge=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];for(var r=0;r<e.length;++r){for(var i=0;i<e[r].textConstraints.length;++i)this.textConstraints.push(e[r].textConstraints[i]);this.maxVar<e[r].maxVar&&(this.maxVar=e[r].maxVar)}return this},t.prototype.toDIMACS=function(){return"p cnf "+this.maxVar+" "+this.textConstraints.length+"\n"+this.textConstraints.join("\n")},t.merge=function(){var e=new t;return e.merge.apply(e,arguments),e},t}();e.exports=a},{}],6:[function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=t("./sat_constraints"),i=function(){function t(){n(this,t)}return t.prototype.loadWorker=function(){this.worker=new Worker("gen/minisat_worker.js")},t.prototype.setListener=function(t){this.worker||this.loadWorker(),this.listener&&this.worker.removeEventListener("message",this.listener,!0),this.listener=function(e){var n=e.data.result,r=null,i="ERROR";n&&(r=n.split(" "),i=r.shift(),r=r.map(function(t){return+t})),t(i,r,e.data.stdout,e.data.stderr)},this.worker.addEventListener("message",this.listener,!0)},t.prototype.solve=function(t,e){var n=t.toDIMACS();this.setListener(e),this.worker.postMessage(n)},t.prototype.solve_loop=function(t,e){var n=this;this.setListener(function(i,o,a,s){var u=e(t,i,o,a,s);if(u!==!1){if(u instanceof r)return t=u,void n.worker.postMessage(u.toDIMACS());throw new TypeError}}),this.worker.postMessage(t.toDIMACS())},t}();e.exports=i},{"./sat_constraints":5}],7:[function(t){(function(e){"use strict";var n="undefined"!=typeof window?window.jQuery:"undefined"!=typeof e?e.jQuery:null,r=t("./lib/puzzle_field"),i=t("./lib/environment_check"),o=t("./lib/lap_timer"),a=t("./lib/sat_constraints"),s=t("./lib/sat_solver"),u=t("./lib/combination");n(function(){if(!i)return void alert("この環境ではJavaScriptの機能が不足していて、実行できません。");var t=new r("#field"),e=[0],f=new s;f.loadWorker(),n("#make_field_btn").click(function(){var r=parseInt(n("#width").val(),10),i=parseInt(n("#height").val(),10);return r>=2&&i>=2?(t.setSize(r,i),void(e=[0])):void alert("2×2以上で設定してください。")}),n("#make_field_btn").click(),t.changeFunc=function(t,n){var r=+t;if(0!==r||n){var i=n?1:-1;for(e[r]-=1;r+=i,2===e[r]&&r>0;);return e[r]||(e[r]=0),e[r]+=1,r||""}};var c=n("#indicator"),l=new o(function(t){return n("<p />").text(t).appendTo(c)});n("#solve_btn").click(function(){function e(e,n,r){return(n*t.width+e)*o+r}function r(n,r,i){var o=[];return n>0&&o.push(e(n-1,r,i)),r>0&&o.push(e(n,r-1,i)),n<t.width-1&&o.push(e(n+1,r,i)),r<t.height-1&&o.push(e(n,r+1,i)),o}l.start();var i={},o=0;if(t.eachCell(function(t){t=+t,t&&(i[t]||(i[t]=0),i[t]+=1,t>o&&(o=t))}),0===o)return void alert("数字が1つもないので終了します。");for(var s in i){var c=i[s];if(2!==c)return void alert("数字は2つずつ入れてください。")}l.lap("条件チェック");var h=new a,p=new a;t.eachCell(function(t,n,i){var a=+t;if(a){for(var s=r(n,i,a),f=1;o>=f;++f){var c=e(n,i,f);f!=a&&(c=-c),h.add(c)}h.add(s),u(s,2).forEach(function(t){return void h.add([-t[0],-t[1]])})}else!function(){var t=e(n,i,1),s=void 0,f=[];for(s=0;o>s;++s)f.push(t+s);for(u(f,2).forEach(function(t){return void h.add([-t[0],-t[1]])}),p.add(f),a=1;o>=a;++a){var c=r(n,i,a),l=u(c,3);switch(l.forEach(function(t){return void h.add([-t[0],-t[1],-t[2]])}),t=e(n,i,a),c.length){case 3:l=u(c,2);case 4:l.forEach(function(e){return void h.add([-t].concat(e))});break;case 2:h.add([-t,c[0]]),h.add([-t,c[1]])}}}()}),l.lap("立式");var d=h;n("#initial_kansai").is(":checked")||(d=a.merge(h,p)),f.solve(d,function(e,r){if(l.lap("初回ソルバー"),"SAT"!==e)return void alert("解が見つかりませんでした。");var i=r.filter(function(t){return t>0}),a=[],s=!1,u=void 0,c=void 0,p=void 0,d=void 0,v=void 0;for(i.length<t.width*t.height&&(alert("関西解です。"),s=!0),c=0;c<t.height;++c)a.push([]);for(p=0;p<i.length;++p)d=(i[p]-1)%o+1,c=Math.floor((i[p]-d)/o/t.width),u=(i[p]-d)/o-c*t.width,a[c][u]=d;var y={};for(y[3]="│",y[5]="┌",y[6]="└",y[9]="┐",y[10]="┘",y[12]="─",c=0,c=0;c<t.height;++c)for(u=0;u<t.width;++u)d=a[c][u],d?(v=0,u>0&&a[c][u-1]==d&&(v+=8),u<t.width-1&&a[c][u+1]==d&&(v+=4),c>0&&a[c-1][u]==d&&(v+=2),c<t.height-1&&a[c+1][u]==d&&(v+=1),y[v]&&t.setValue(u,c,y[v])):t.setValue(u,c,"");return console.log(a),l.lap("出力"),s?void l.finish():void(n("#bypass_unique").is(":checked")||(h.add(i.map(function(t){return-t})),f.solve(h,function(t){l.finish("別解チェック"),alert("SAT"===t?"別解があります。":"一意解です。")})))})})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/combination":1,"./lib/environment_check":2,"./lib/lap_timer":3,"./lib/puzzle_field":4,"./lib/sat_constraints":5,"./lib/sat_solver":6}]},{},[7]);